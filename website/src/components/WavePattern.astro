---
/**
 * WavePattern.astro
 * Decorative Japanese Seigaiha (wave) pattern
 * Can be used as section backgrounds or dividers
 */

interface Props {
  position?: "top" | "bottom";
  flip?: boolean;
  animate?: boolean;
}

const { position = "bottom", flip = false, animate = false } = Astro.props;
---

<div 
  class:list={[
    "wave-pattern", 
    `wave-pattern--${position}`,
    { "wave-pattern--flip": flip },
    { "wave-pattern--animate": animate }
  ]} 
  aria-hidden="true"
>
  <svg class="wave-pattern__svg" viewBox="0 0 1440 120" preserveAspectRatio="none">
    <defs>
      <linearGradient id="waveGradient" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color="var(--color-accent-tertiary)" stop-opacity="0.1" />
        <stop offset="50%" stop-color="var(--color-accent-primary)" stop-opacity="0.15" />
        <stop offset="100%" stop-color="var(--color-accent-tertiary)" stop-opacity="0.1" />
      </linearGradient>
      
      <!-- Seigaiha Pattern Definition -->
      <pattern id="seigaiha" x="0" y="0" width="80" height="40" patternUnits="userSpaceOnUse">
        <g fill="none" stroke="var(--color-accent-secondary)" stroke-width="0.5" opacity="0.3">
          <!-- First row of arcs -->
          <path d="M0 40 A40 40 0 0 1 40 0 A40 40 0 0 1 80 40" />
          <path d="M0 40 A30 30 0 0 1 30 10 Q40 0 50 10 A30 30 0 0 1 80 40" />
          <path d="M0 40 A20 20 0 0 1 20 20 Q40 0 60 20 A20 20 0 0 1 80 40" />
          <!-- Offset row -->
          <path d="M-40 40 A40 40 0 0 1 0 0 A40 40 0 0 1 40 40" transform="translate(0, 40)" />
          <path d="M40 40 A40 40 0 0 1 80 0 A40 40 0 0 1 120 40" transform="translate(0, 40)" />
        </g>
      </pattern>
    </defs>
    
    <!-- Base wave -->
    <path 
      class="wave wave--1"
      d="M0,60 C240,120 480,0 720,60 C960,120 1200,0 1440,60 L1440,120 L0,120 Z"
      fill="url(#waveGradient)"
    />
    
    <!-- Second wave layer -->
    <path 
      class="wave wave--2"
      d="M0,80 C180,40 360,100 540,80 C720,60 900,100 1080,80 C1260,60 1350,90 1440,80 L1440,120 L0,120 Z"
      fill="var(--color-accent-primary)"
      opacity="0.08"
    />
    
    <!-- Third wave layer -->
    <path 
      class="wave wave--3"
      d="M0,95 C120,85 240,105 360,95 C480,85 600,105 720,95 C840,85 960,105 1080,95 C1200,85 1320,105 1440,95 L1440,120 L0,120 Z"
      fill="var(--color-accent-secondary)"
      opacity="0.06"
    />
    
    <!-- Seigaiha pattern overlay -->
    <rect x="0" y="0" width="100%" height="100%" fill="url(#seigaiha)" opacity="0.5" />
  </svg>
</div>

<style>
  .wave-pattern {
    position: absolute;
    left: 0;
    right: 0;
    width: 100%;
    height: 80px;
    overflow: hidden;
    pointer-events: none;
    z-index: 1;
  }
  
  .wave-pattern--top {
    top: 0;
  }
  
  .wave-pattern--bottom {
    bottom: 0;
  }
  
  .wave-pattern--flip {
    transform: scaleY(-1);
  }
  
  .wave-pattern__svg {
    width: 100%;
    height: 100%;
  }
  
  /* Animated waves */
  .wave-pattern--animate .wave--1 {
    animation: wave-float 8s ease-in-out infinite;
  }
  
  .wave-pattern--animate .wave--2 {
    animation: wave-float 10s ease-in-out infinite reverse;
  }
  
  .wave-pattern--animate .wave--3 {
    animation: wave-float 12s ease-in-out infinite;
  }
  
  @keyframes wave-float {
    0%, 100% {
      transform: translateX(0);
    }
    50% {
      transform: translateX(-20px);
    }
  }
  
  @media (prefers-reduced-motion: reduce) {
    .wave-pattern--animate .wave--1,
    .wave-pattern--animate .wave--2,
    .wave-pattern--animate .wave--3 {
      animation: none;
    }
  }
  
  @media (min-width: 768px) {
    .wave-pattern {
      height: 100px;
    }
  }
  
  @media (min-width: 1200px) {
    .wave-pattern {
      height: 120px;
    }
  }
</style>
